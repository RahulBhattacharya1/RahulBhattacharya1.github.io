---
layout: default
title: "Rahul's Portfolio"
---

<section class="featured">
  <div class="posts-header">
    <h2>Featured</h2>

    <!-- Featured pager (same look as Blog pager) -->
    <nav class="pagination bio-tabs featured-pager" aria-label="Featured Pagination">
      <div class="tab-buttons">
        <a class="tab-btn prev is-disabled" href="#">← Newer</a>
        <span class="tab-btn active" style="pointer-events:none;cursor:default;
            background:#D2E2FD; color:#01068B;
            letter-spacing: 0.15em;">1/1</span>
        <a class="tab-btn next is-disabled" href="#">Older →</a>
      </div>
    </nav>
  </div>

  <!-- Render ALL featured items once; JS will show 2 at a time with fade -->
  <ul id="featured-strip" class="featured-strip">
    {%- for post in site.posts -%}
      {%- if post.featured == true -%}
        <li class="post-item">
          <a class="thumb" href="{{ post.url | relative_url }}" aria-label="{{ post.title }}">
            <picture>
              {% if post.thumbnail_mobile %}
                <source srcset="{{ post.thumbnail_mobile | relative_url }}" media="(max-width: 767px)">
              {% endif %}
              {% if post.thumbnail %}
                <source srcset="{{ post.thumbnail | relative_url }}" media="(min-width: 768px)">
              {% endif %}
              <img src="{{ (post.thumbnail | default: post.image | default: '/assets/images/default.webp') | relative_url }}"
                   alt="{{ post.title }}" loading="lazy">
            </picture>

          </a>
          <div class="post-text">
            <a class="title" href="{{ post.url | relative_url }}"><strong>{{ post.title }}</strong></a>
            <p class="snippet" style="color:#737373">
              {% if post.custom_snippet and post.custom_snippet_text %}
                {{ post.custom_snippet_text }}
              {% else %}
                {{ post.excerpt | strip_html | truncate: 70 }}
              {% endif %}
            </p>
            <div class="author-meta">
              <img src="/assets/images/avatar.webp" alt="Rahul" class="author-avatar">
              <span class="author-name">Rahul Bhattacharya</span>
            </div>
            <div class="icon-links">
              {% if post.demo_link %}
                <a class="btn-cta" href="{{ post.demo_link }}" target="_blank" rel="noopener">
                  <img src="/assets/icons/play.svg" alt="Play Icon" style="height:17px; width: 17px !important; vertical-align:-0.26em; margin:0 2px 0 0;">
                </a>
              {% endif %}
              {% if post.github_link %}
                <a class="btn-cta" href="{{ post.github_link }}" target="_blank" rel="noopener">
                  <img src="/assets/icons/github.svg" alt="Github Icon" style="height:16px; width: 16px !important; vertical-align:-0.35em; margin:0 2px 0 0;">
                </a>
              {% endif %}
              <span class="post-stats">
              <button
                class="btn btn--like btn--like--mini"
                type="button"
                data-like-id="{{ post.url | slugify }}"
                data-like-pub="{{ post.date | date: '%Y-%m-%d' }}"
                aria-label="Like this post"
                aria-pressed="false">
                <span class="icon" aria-hidden="true">
                  <svg class="heart" width="12" viewBox="0 0 24 24" fill="none">
                    <path fill-rule="evenodd" clip-rule="evenodd"
                          d="M12 6.00019C10.2006 3.90317 7.19377 3.2551 4.93923 5.17534C2.68468 7.09558 2.36727 10.3061 4.13778 12.5772C5.60984 14.4654 10.0648 18.4479 11.5249 19.7369C11.6882 19.8811 11.7699 19.9532 11.8652 19.9815C11.9483 20.0062 12.0393 20.0062 12.1225 19.9815C12.2178 19.9532 12.2994 19.8811 12.4628 19.7369C13.9229 18.4479 18.3778 14.4654 19.8499 12.5772C21.6204 10.3061 21.3417 7.07538 19.0484 5.17534C16.7551 3.2753 13.7994 3.90317 12 6.00019Z"
                          stroke="#d61f69" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </span>
                <span class="count"></span>
              </button>

    <!-- Share icon -->
<button
  class="btn btn--share btn--share--mini"
  type="button"
  data-share-id="{{ post.url | slugify }}"
  data-share-pub="{{ post.date | date: '%Y-%m-%d' }}"
  data-url="{{ post.url | absolute_url }}"
  aria-label="Share this post">
  <span class="icon" aria-hidden="true">
    <svg width="12" height="12" viewBox="0 0 24 24" fill="none">
      <path fill-rule="evenodd" clip-rule="evenodd"
        d="M1 18.5088C1 13.1679 4.90169 8.77098 9.99995 7.84598V5.51119C9.99995 3.63887 12.1534 2.58563 13.6313 3.73514L21.9742 10.224C23.1323 11.1248 23.1324 12.8752 21.9742 13.7761L13.6314 20.2649C12.1534 21.4144 10 20.3612 10 18.4888V16.5189C7.74106 16.9525 5.9625 18.1157 4.92778 19.6838C4.33222 20.5863 3.30568 20.7735 2.55965 20.5635C1.80473 20.3511 1.00011 19.6306 1 18.5088ZM12.4034 5.31385C12.2392 5.18613 11.9999 5.30315 11.9999 5.51119V9.41672C11.9999 9.55479 11.8873 9.66637 11.7493 9.67008C8.09094 9.76836 4.97774 12.0115 3.66558 15.1656C3.46812 15.6402 3.31145 16.1354 3.19984 16.6471C3.07554 17.217 3.00713 17.8072 3.00053 18.412C3.00018 18.4442 3 18.4765 3 18.5088C3.00001 18.6437 3.18418 18.6948 3.25846 18.5822C3.27467 18.5577 3.29101 18.5332 3.30747 18.5088C3.30748 18.5088 3.30746 18.5088 3.30747 18.5088C3.63446 18.0244 4.01059 17.5765 4.42994 17.168C4.71487 16.8905 5.01975 16.6313 5.34276 16.3912C7.05882 15.1158 9.28642 14.3823 11.7496 14.3357C11.8877 14.3331 12 14.4453 12 14.5834V18.4888C12 18.6969 12.2393 18.8139 12.4035 18.6862L20.7463 12.1973C20.875 12.0973 20.875 11.9028 20.7463 11.8027L12.4034 5.31385Z"
        fill="currentColor"/>
    </svg>
  </span>
  <span class="count"></span>
</button>


            </span>
            </div>
          </div>
        </li>
      {%- endif -%}
    {%- endfor -%}
  </ul>
</section>

<section class="posts">
  <div class="posts-header">
    <h2>Blog Posts</h2>

    {% if paginator %}
    <!-- Header pager using the About-style buttons -->
      <nav class="pagination bio-tabs" aria-label="Pagination">
        <div class="tab-buttons">
          <a class="tab-btn prev{% unless paginator.previous_page %} is-disabled{% endunless %}"
             href="{{ paginator.previous_page_path | relative_url }}">← Newer</a>
      
          <span class="tab-btn active" style="pointer-events:none; 
            cursor:default; background:#D2E2FD; color:#01068B;
            letter-spacing: 0.15em;">
            {{ paginator.page }}/{{ paginator.total_pages }}
          </span>
      
          <a class="tab-btn next{% unless paginator.next_page %} is-disabled{% endunless %}"
             href="{{ paginator.next_page_path | relative_url }}">Older →</a>
        </div>
      </nav>
    {% endif %}
  </div>

  <ul id="post-strip" class="post-strip">
    {% if paginator %}
      {% for post in paginator.posts %}
        <li class="post-item">
          <a class="thumb" href="{{ post.url | relative_url }}" aria-label="{{ post.title }}">
            <picture>
              {% if post.thumbnail_mobile %}
                <source srcset="{{ post.thumbnail_mobile | relative_url }}" media="(max-width: 767px)">
              {% endif %}
              {% if post.thumbnail %}
                <source srcset="{{ post.thumbnail | relative_url }}" media="(min-width: 768px)">
              {% endif %}
              <img src="{{ (post.thumbnail | default: post.image | default: '/assets/images/default.webp') | relative_url }}"
                   alt="{{ post.title }}" loading="lazy">
            </picture>
          </a>
          <div class="post-text">
            <a href="{{ post.url | relative_url }}"><strong>{{ post.title }}</strong></a>
            <p class = "snippet" style="color: #737373">
              {% if post.custom_snippet and post.custom_snippet_text %}
                {{ post.custom_snippet_text }}
              {% else %}
                {{ post.excerpt | strip_html | truncate: 200 }}
              {% endif %}
            </p>
            <div class="author-meta">
              <img src="/assets/images/avatar.webp" alt="Rahul" class="author-avatar">
              <span class="author-name">Rahul Bhattacharya</span>
            </div>
            <div class="icon-links">
              {% if post.demo_link %}
                <a class="btn-cta" href="{{ post.demo_link }}" target="_blank" rel="noopener">
                  <img src="/assets/icons/play.svg" alt="Play Icon" style="height:17px; width: 17px !important; vertical-align:-0.26em; margin:0 2px 0 0;">
                </a>
              {% endif %}
              {% if post.github_link %}
                <a class="btn-cta" href="{{ post.github_link }}" target="_blank" rel="noopener">
                  <img src="/assets/icons/github.svg" alt="Github Icon" style="height:16px; width: 16px !important; vertical-align:-0.35em; margin:0 2px 0 0;">
                </a>
              {% endif %}
              <span class="post-stats">
              <button
                class="btn btn--like btn--like--mini"
                type="button"
                data-like-id="{{ post.url | slugify }}"
                data-like-pub="{{ post.date | date: '%Y-%m-%d' }}"
                aria-label="Like this post"
                aria-pressed="false">
                <span class="icon" aria-hidden="true">
                  <svg class="heart" width="12" viewBox="0 0 24 24" fill="none">
                    <path fill-rule="evenodd" clip-rule="evenodd"
                          d="M12 6.00019C10.2006 3.90317 7.19377 3.2551 4.93923 5.17534C2.68468 7.09558 2.36727 10.3061 4.13778 12.5772C5.60984 14.4654 10.0648 18.4479 11.5249 19.7369C11.6882 19.8811 11.7699 19.9532 11.8652 19.9815C11.9483 20.0062 12.0393 20.0062 12.1225 19.9815C12.2178 19.9532 12.2994 19.8811 12.4628 19.7369C13.9229 18.4479 18.3778 14.4654 19.8499 12.5772C21.6204 10.3061 21.3417 7.07538 19.0484 5.17534C16.7551 3.2753 13.7994 3.90317 12 6.00019Z"
                          stroke="#d61f69" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </span>
                <span class="count"></span>
              </button>
            </span>
            </div>

          </div>
        </li>
      {% endfor %}
    {% endif %}
  </ul>
</section>

<style>
.post-strip .post-text p {
  font-size: 0.85rem;    /* match Featured */
  line-height: 1.4;
}

/* Optional: unify base + hover so pills feel consistent */
.posts-header .bio-tabs .tab-btn {
  font-weight: 600;
  border: 1px solid #d0d7de;
  border-radius: 999px;
  padding: 4px 10px;
}

/* Disabled edge buttons (when no previous/next) */
.posts-header .bio-tabs .tab-btn.is-disabled {
  opacity: .45;
  pointer-events: none;
}

/* --- Easy color theming via CSS variables --- */
/* Set these wherever you prefer (global :root or scoped to the posts header) */
.posts-header .bio-tabs {
  --pager-active-bg: #D2E2FD; /* change this to your desired background */
  --pager-active-fg: #01068B; /* and this to your desired text color */
}

  /* Tighten space between underline and buttons in header */

.posts-header .bio-tabs,
.posts-header .pagination { margin: 0; }           /* remove bottom margin */

.posts-header .tab-buttons { 
  gap: .5rem;                                       /* optional: tighter pill spacing */
  align-items: flex-end; 
}


  /* Keep "Blog Posts" on one line */
.posts-header h2{
  white-space:nowrap;          /* don't wrap "Blog Posts" */
  margin:0;                    /* avoid extra vertical space */
  line-height:1.2;
}

/* Align the header row neatly with About-style buttons */
.posts-header{
  display:flex;align-items:flex-end;justify-content:space-between;
  gap:.75rem;border-bottom:2px solid #ddd;margin-bottom:1.2rem
}

.posts-header h2{margin:0 0 .4rem 0;font-size:1.4rem;font-weight:700;line-height:1.2}

.pagination{display:flex;justify-content:flex-end}
  
/* Compact like widget for index cards */
.post-text .post-stats{
  margin-top:6px;
}
.btn--like.btn--like--mini{
  display:inline-flex;
  align-items:center;
  gap:4px;
  border:0;
  background:transparent;
  padding:0;
  line-height:1;
  cursor:pointer;
}
.btn--like.btn--like--mini .icon .heart{
  width:14px; height:auto;
}
.btn--like.btn--like--mini .label{ display:none; }  /* just heart + number */
.btn--like.btn--like--mini .count{
  font-size:.85rem;
  color:#6b7280;
}


/* Featured: 2 cards per row; each card is image-left + text-right */
.featured-strip{
  list-style:none; margin:0; padding:0;
  display:grid;
  grid-template-columns: repeat(2, minmax(0,1fr)); /* two side-by-side items */
  gap: 14px 18px;  /* row gap, column gap */
}

.featured-strip .post-text .snippet {
  font-size: 0.85rem;    /* smaller body text */
  line-height: 1.4;
}

/* Each card: media layout */
.featured-strip .post-item{
  display:flex;
  align-items:flex-start;
  gap:12px;
  width:100%;
}

/* Image block */
.featured-strip .post-item .thumb{ flex:0 0 auto; display:block; }
.featured-strip .post-item .thumb img{
  width:170px;              /* adjust if you want wider image */
  height:110px;
  object-fit:cover;
  border-radius:10px;
}

/* Text block */
.featured-strip .post-item .post-text{ flex:1 1 auto; min-width:0; }
.featured-strip .post-item .post-text .title{ display:inline-block; margin-bottom:.25rem; }
.featured-strip .post-item .post-text .snippet{ margin:0; color:#555; }

/* Same fade as blog */
.featured-strip{
  transition: opacity .24s ease, transform .24s ease; opacity:1;
}
.featured-strip.fade-out{ opacity:0; transform:translateY(4px); }
.featured-strip.fade-in { opacity:1; transform:translateY(0); }



/* MOBILE: neutralize main.scss card constraints that create gaps */
@media (max-width: 720px) {

  .post-text .snippet{ display:none !important; }

  /* Let the list be a vertical stack with controlled spacing */
   .post-strip{
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
    margin: 0 !important;
    padding: 0 !important;                 /* overrides main.scss bottom padding */
    list-style: none !important;
    overflow: visible !important;
  }

  /* Override the fixed card width/basis from main.scss */
  .post-strip > .post-item{
    flex: 1 1 auto !important;             /* was flex: 0 0 var(--card-w,180px) */
    max-width: 100% !important;
    gap:8px !important; /* gap between thumbnail and post title */
  }

  /* Make each card row-style (image left, text right) full-width */
  .post-strip .post-item{
    display: flex !important;
    flex-direction: row !important;        /* was column */
    align-items: flex-start !important;
    max-width: 100% !important;            /* was var(--card-w,180px) */
    margin: 0 0 4px 0 !important;
    padding: 0 !important;
  }

  /* Tighten media/text spacing */
  .post-strip .post-item .thumb{
    flex: 0 0 110px !important;            /* give text room */
    max-width: 110px !important;
    margin: 0 !important;                  /* kills .6rem bottom margin from SCSS */
  }

  .post-strip .post-item .post-text{
    flex: 1 1 auto !important;
    min-width: 0 !important;
  }

  .post-strip .post-item .post-text a{
    margin-bottom: 0.2rem !important;      /* was .4rem in SCSS */
  }

  .post-strip .post-item .post-text p{
    margin: 0.3rem 0 0 !important;
    line-height: 1.4 !important;
    font-size: .9rem !important;
  }

  /* Also neutralize the 640px flex-basis=240px rule from main.scss */
  .post-strip > .post-item{ flex-basis: auto !important; }

/* MOBILE ONLY: make blog thumbnails perfect 1:1 squares */

  /* choose your square size once */
  :root { --mobile-thumb: 110px; }   /* try 120–140px if you want larger */

  /* the thumbnail column */
  section.posts .post-strip .thumb{
    flex: 0 0 var(--mobile-thumb) !important;
    width: var(--mobile-thumb) !important;
    max-width: var(--mobile-thumb) !important;
  }

  /* ensure the <picture> wrapper conforms to the square */
  section.posts .post-strip .thumb picture{
    display: block !important;
    width: var(--mobile-thumb) !important;
    height: var(--mobile-thumb) !important;
  }

  /* force the <img> to fill the square and crop neatly */
  section.posts .post-strip .thumb img{
    display: block !important;
    width: var(--mobile-thumb) !important;
    height: var(--mobile-thumb) !important;
    max-width: none !important;        /* override any global img max-width */
    aspect-ratio: 1 / 1 !important;
    object-fit: cover !important;      /* clean crop */
    border-radius: 10px;               /* keep your rounded look */
  }

  /* let text take the rest of the row */
  section.posts .post-strip .post-text{
    flex: 1 1 auto !important;
    min-width: 0 !important;
  }

  /* MOBILE: make Featured stack vertically like Posts */
  /* same container behavior for both lists */
  #post-strip,
  #featured-strip {
    display: flex !important;
    flex-direction: column !important;
    gap: 14px !important;        /* gap between vertical posts */
    margin: 0 !important;
    padding: 0 !important;
    list-style: none !important;
  }

  /* row layout for cards (image left, text right) */
  #featured-strip .post-item,
  #post-strip .post-item {
    display: flex !important;
    flex-direction: row !important;
    align-items: flex-start !important;
    gap: 10px !important;
    margin: 0 !important;
    padding: 0 !important;
    max-width: 100% !important;
  }

  /* Featured: allow pager JS to hide non-current items */
  #featured-strip .post-item {
    display: flex;                 /* no !important */
    flex-direction: row;
    align-items: flex-start;
    gap: 10px;
    margin: 0;
    padding: 0;
    max-width: 100%;
  }

  /* optional: keep thumbnails consistent (square) */
  :root { --mobile-thumb: 110px; }  /* adjust to 120–140px if desired */

  #featured-strip .thumb,
  #post-strip .thumb {
    flex: 0 0 var(--mobile-thumb) !important;
    max-width: var(--mobile-thumb) !important;
    width: var(--mobile-thumb) !important;
  }

  #featured-strip .thumb picture,
  #post-strip .thumb picture {
    display: block !important;
    width: var(--mobile-thumb) !important;
    height: var(--mobile-thumb) !important;
  }

  #featured-strip .thumb img,
  #post-strip .thumb img {
    display: block !important;
    width: var(--mobile-thumb) !important;
    height: var(--mobile-thumb) !important;
    aspect-ratio: 1 / 1 !important;
    object-fit: cover !important;
    border-radius: 10px;
  }

  #featured-strip .post-text,
  #post-strip .post-text {
    flex: 1 1 auto !important;
    min-width: 0 !important;
  }

  /* compact body copy */
  #featured-strip .post-text p,
  #post-strip .post-text p {
    margin: 0.3rem 0 0 !important;
    line-height: 1.4 !important;
  }

  #featured-strip .post-item[style*="display: none"] { display: none !important; }
  
}

/* Author row under snippets */
.author-meta{
  display:flex;
  align-items:center;
  gap:6px;
  margin-top:6px;
  font-size:.8rem;           /* subtle like the example */
  color:#6b7280;             /* muted gray */
}

.author-meta .author-name{
  line-height:1;
  white-space:nowrap;
}

.author-avatar{
  width:16px;                /* tiny circle */
  height:16px;
  border-radius:50%;
  object-fit:cover;
  display:block;
}

/* Optional: make it even tighter on small phones */
@media (max-width: 480px){
  .author-meta{ font-size:.76rem; gap:5px; }
  .author-avatar{ width:15px; height:15px; }
}

/* Author row — force tiny circle and prevent theme image rules from scaling it */
.post-text .author-meta{
  display:flex;
  align-items:center;
  gap:6px;
  margin-top:6px;
  font-size:.8rem;
  color:#6b7280;
}

.post-text .author-meta .author-avatar{
  width:18px !important;
  height:18px !important;
  border-radius:50% !important;
  object-fit:cover !important;
  display:inline-block !important;
  flex:0 0 18px;            /* reserve tiny fixed space */
  margin:0;                 /* neutralize any global img margins */
  vertical-align:middle;
}

/* optional: slightly smaller on very small phones */
@media (max-width: 480px){
  .post-text .author-meta{ font-size:.76rem; gap:5px; }
  .post-text .author-meta .author-avatar{ width:16px !important; height:16px !important; flex-basis:16px; }
}

  .icon-links{
  display:flex;
  align-items:center;
  gap:10px; /* spacing between demo/github/like */
}

.icon-links img,
.icon-links svg.heart{
  width:18px;
  height:18px;
}

.post-stats{
  display:inline-flex; /* ensures the heart + count stay together */
  align-items:center;
}

/* Share button: no border, transparent background */
.btn--share.btn--share--mini {
  display: inline-flex;
  align-items: center;
  gap: 4px;
  border: 0;
  background: transparent;
  padding: 0;
  line-height: 1;
  cursor: pointer;
  color: #2563eb; /* base blue */
}

/* Icon sizing */
.btn--share.btn--share--mini .icon svg {
  width: 14px;
  height: auto;
  display: block;
  fill: none;               /* outline only */
  stroke: currentColor;     /* blue outline */
  stroke-width: 2;
}

/* Count — match like button color */
.btn--share.btn--share--mini .count {
  font-size: .85rem;
  color: #6b7280;
}

/* Shared state: arrow filled blue */
.btn--share.btn--share--mini.shared .icon svg {
  fill: #2563eb;   /* solid blue fill */
  stroke: #2563eb; /* stroke same as fill */
}

</style>

<script>
(function(){
  if (window.__fadePager_v5) return; window.__fadePager_v5 = true;

  var section = document.querySelector('section.posts');
  var strip   = section && section.querySelector('#post-strip');
  var pagers  = Array.from(section ? section.querySelectorAll('nav.pagination') : []);
  if (!section || !strip || !pagers.length) return;

  function parseHTML(html){ var t=document.createElement('template'); t.innerHTML=html; return t.content; }
  function fetchPage(url){ return fetch(url,{credentials:'same-origin'}).then(r=>r.text()); }
  function syncPagersFrom(doc){
    var src = doc.querySelector('section.posts nav.pagination');
    if (!src) return;
    pagers.forEach(p=>{ p.innerHTML = src.innerHTML; });
  }

  function selNextFrom(doc){
    var a = doc.querySelector('section.posts nav.pagination .next');
    return (a && !a.classList.contains('is-disabled')) ? a.getAttribute('href') : null;
  }
  function selPrevFrom(doc){
    var a = doc.querySelector('section.posts nav.pagination .prev');
    return (a && !a.classList.contains('is-disabled')) ? a.getAttribute('href') : null;
  }

  function computeColumns(){
    var first = strip.querySelector('li.post-item');
    if (!first) return 1;
    var r = first.getBoundingClientRect();
    var cs = getComputedStyle(strip);
    var gap = parseFloat(cs.columnGap || cs.gap || 0) || 0;
    var cardW = r.width;
    var contW = strip.clientWidth;
    return Math.max(1, Math.floor((contW + gap) / (cardW + gap)));
  }

  function cardKey(li){
    var a = li.querySelector('.thumb, a[href]');
    return a ? a.getAttribute('href') : Math.random().toString(36);
  }

  function getCardsFrom(url){
    if (!url) return Promise.resolve({doc:null,cards:[]});
    return fetchPage(url).then(html=>{
      var doc   = parseHTML(html);
      var cards = Array.from(doc.querySelectorAll('section.posts ul li.post-item'));
      return {doc:doc, cards:cards};
    });
  }

  // Top up: try next pages, then previous pages, until we fill the row
  function topUpRow(seedDoc){
    var need = computeColumns() - strip.children.length;
    if (need <= 0) return Promise.resolve();

    var seen = new Set(Array.from(strip.children).map(cardKey));
    var nextHref = selNextFrom(seedDoc || document);
    var prevHref = selPrevFrom(seedDoc || document);

    function take(cards, howMany){
      var taken = [];
      for (var i=0;i<cards.length && taken.length<howMany;i++){
        var k = cardKey(cards[i]);
        if (seen.has(k)) continue;
        seen.add(k);
        taken.push(cards[i]);
      }
      taken.forEach(li=>strip.appendChild(li));
      return howMany - taken.length;
    }

    function fillForward(rem){
      if (rem <= 0 || !nextHref) return Promise.resolve(rem);
      return getCardsFrom(nextHref).then(({doc,cards})=>{
        rem = take(cards, rem);
        nextHref = doc ? selNextFrom(doc) : null;
        return (rem>0 && nextHref) ? fillForward(rem) : rem;
      }).catch(()=>rem);
    }

    function fillBackward(rem){
      if (rem <= 0 || !prevHref) return Promise.resolve(rem);
      return getCardsFrom(prevHref).then(({doc,cards})=>{
        // from prev page take from the END so we don’t just re-show its first items
        cards = cards.slice().reverse();
        rem = take(cards, rem);
        prevHref = doc ? selPrevFrom(doc) : null;
        return (rem>0 && prevHref) ? fillBackward(rem) : rem;
      }).catch(()=>rem);
    }

    return fillForward(need).then(fillBackward).then(()=>{ /* done */ });
  }

  var busy = false;

  function fadeSwap(newLis, newDoc){
    strip.classList.add('fade-out');
    setTimeout(function(){
      strip.innerHTML = '';
      newLis.forEach(li=>strip.appendChild(li));
      syncPagersFrom(newDoc);
      strip.classList.remove('fade-out');
      void strip.offsetWidth;
      strip.classList.add('fade-in');

      topUpRow(newDoc).finally(function(){
        setTimeout(()=>strip.classList.remove('fade-in'), 260);
        busy = false;
      });
    }, 260);
  }

  function handle(dir){
    if (busy) return;
    var link = section.querySelector('nav.pagination ' + (dir===1?'.next':'.prev'));
    if (!link || link.classList.contains('is-disabled')) return;
    var href = link.getAttribute('href'); if (!href) return;

    busy = true;
    pagers.forEach(p=>p.querySelectorAll('a,button').forEach(a=>a.classList.add('is-disabled')));

    fetchPage(href).then(html=>{
      var doc = parseHTML(html);
      var cards = doc.querySelectorAll('section.posts ul li.post-item');
      if (!cards.length){ busy=false; return; }
      fadeSwap(Array.from(cards), doc);
    }).catch(()=>{ busy=false; });
  }

  // Pager clicks
  document.addEventListener('click', function(e){
    var a = e.target.closest('section.posts nav.pagination a');
    if (!a) return;
    e.preventDefault();
    e.stopPropagation();
    e.stopImmediatePropagation();
    if (a.classList.contains('prev')) handle(-1);
    else if (a.classList.contains('next')) handle(1);
  }, true);

  // First paint + resize top-up
  window.addEventListener('load', function(){ setTimeout(function(){ topUpRow(document); }, 50); });
  var rAF, lastW = 0;
  window.addEventListener('resize', function(){
    if (strip.clientWidth === lastW) return;
    lastW = strip.clientWidth;
    if (rAF) cancelAnimationFrame(rAF);
    rAF = requestAnimationFrame(function(){ topUpRow(document); });
  });
})();
</script>

<script>
(function(){
  var strip = document.getElementById('featured-strip');
  var pager = document.querySelector('.featured-pager');
  if (!strip || !pager) return;

  var items = Array.from(strip.querySelectorAll('li.post-item'));
  var pageSize = 2;                                   // 2 cards per page
  var totalPages = Math.max(1, Math.ceil(items.length / pageSize));
  var cur = 1;

  var prev = pager.querySelector('.prev');
  var next = pager.querySelector('.next');
  var counter = pager.querySelector('.tab-btn.active');

  var busy = false;                                   // ← guard during fade

  function render(){
    busy = true;
    strip.classList.add('fade-out');
    setTimeout(function(){
      items.forEach(el => el.style.display = 'none');
      var start = (cur - 1) * pageSize;
      items.slice(start, start + pageSize).forEach(el => el.style.display = '');

      counter.textContent = cur + '/' + totalPages;
      prev.classList.toggle('is-disabled', cur <= 1);
      next.classList.toggle('is-disabled', cur >= totalPages);

      strip.classList.remove('fade-out');
      void strip.offsetWidth;                         // reflow
      strip.classList.add('fade-in');
      setTimeout(function(){
        strip.classList.remove('fade-in');
        busy = false;
      }, 260);
    }, 260);
  }

  function go(delta){
    if (busy) return;                                 // ← ignore while animating
    var target = cur + delta;
    if (target < 1 || target > totalPages) return;
    cur = target;
    render();
  }

  // Capture-phase handler that *blocks* any other global .tab-btn listeners
  document.addEventListener('click', function(e){
    var a = e.target.closest('.featured-pager a.tab-btn');
    if (!a) return;

    e.preventDefault();
    e.stopPropagation();
    e.stopImmediatePropagation();                     // ← hard stop others

    if (a.classList.contains('is-disabled')) return;
    if (a.classList.contains('prev')) go(-1);
    else if (a.classList.contains('next')) go(1);
  }, true);                                           // ← capture

  render(); // initial paint
})();
</script>


