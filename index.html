---
layout: default
title: "Rahul's Portfolio"
---
<section class="featured">
  <div class="posts-header">
    <h2>Featured</h2>

    <!-- Featured pager (same look as Blog pager) -->
    <nav class="pagination bio-tabs featured-pager" aria-label="Featured Pagination">
      <div class="tab-buttons">
        <a class="tab-btn prev is-disabled" href="#">← Newer</a>
        <span class="tab-btn active" style="pointer-events:none;cursor:default;
            background:#D2E2FD; color:#01068B;
            letter-spacing: 0.15em;">1/1</span>
        <a class="tab-btn next is-disabled" href="#">Older →</a>
      </div>
    </nav>
  </div>

  <!-- Render ALL featured items once; JS will show 2 at a time with fade -->
  <ul id="featured-strip" class="featured-strip">
    {%- for post in site.posts -%}
      {%- if post.featured == true -%}
        <li class="post-item">
          <a class="thumb" href="{{ post.url | relative_url }}" aria-label="{{ post.title }}">
            <picture>
              {% if post.thumbnail_mobile %}
                <source srcset="{{ post.thumbnail_mobile | relative_url }}" media="(max-width: 767px)">
              {% endif %}
              {% if post.thumbnail %}
                <source srcset="{{ post.thumbnail | relative_url }}" media="(min-width: 768px)">
              {% endif %}
              <img src="{{ (post.thumbnail | default: post.image | default: '/assets/images/default.webp') | relative_url }}"
                   alt="{{ post.title }}" loading="lazy">
            </picture>

          </a>
          <div class="post-text">
            <a class="title" href="{{ post.url | relative_url }}"><strong>{{ post.title }}</strong></a>
            <p class="snippet" style="color:#737373">
              {% if post.custom_snippet and post.custom_snippet_text %}
                {{ post.custom_snippet_text }}
              {% else %}
                {{ post.excerpt | strip_html | truncate: 70 }}
              {% endif %}
            </p>
            <div class="author-meta">
              <img src="/assets/images/avatar.webp" alt="Rahul" class="author-avatar">
              <span class="author-name">Rahul Bhattacharya</span>
            </div>
            <div class="icon-links">
              {% if post.demo_link %}
                <a class="btn-cta" href="{{ post.demo_link }}" target="_blank" rel="noopener">
                  <img src="/assets/icons/play.svg" alt="Play Icon" 
                    style="height:15px; width: 15px !important; position: relative; top: 1.7px;
                    margin:0 2px 0 0;">
                </a>
              {% endif %}
              {% if post.github_link %}
                <a class="btn-cta" href="{{ post.github_link }}" target="_blank" rel="noopener">
                  <img src="/assets/icons/github.svg" alt="Github Icon" 
                    style="height:13px; width: 13px !important; position: relative; top: 2px;
                    margin:0 2px 0 0;">
                </a>
              {% endif %}
              <span class="post-stats">
              <button
                class="btn btn--like btn--like--mini"
                type="button"
                data-like-id="{{ post.url | slugify }}"
                data-like-pub="{{ post.date | date: '%Y-%m-%d' }}"
                aria-label="Like this post"
                aria-pressed="false">
                <span class="icon" aria-hidden="true">
                  <svg class="heart" width="12" viewBox="0 0 24 24" fill="none">
                    <path fill-rule="evenodd" clip-rule="evenodd"
                          d="M12 6.00019C10.2006 3.90317 7.19377 3.2551 4.93923 5.17534C2.68468 7.09558 2.36727 10.3061 4.13778 12.5772C5.60984 14.4654 10.0648 18.4479 11.5249 19.7369C11.6882 19.8811 11.7699 19.9532 11.8652 19.9815C11.9483 20.0062 12.0393 20.0062 12.1225 19.9815C12.2178 19.9532 12.2994 19.8811 12.4628 19.7369C13.9229 18.4479 18.3778 14.4654 19.8499 12.5772C21.6204 10.3061 21.3417 7.07538 19.0484 5.17534C16.7551 3.2753 13.7994 3.90317 12 6.00019Z"
                          stroke="#d61f69" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </span>
                <span class="count"></span>
              </button>

    <!-- Share icon -->
<button
  class="btn btn--share btn--share--mini"
  type="button"
  data-share-id="{{ post.url | slugify }}"
  data-share-pub="{{ post.date | date: '%Y-%m-%d' }}"
  data-url="{{ post.url | absolute_url }}"
  aria-label="Share this post">
  <span class="icon" aria-hidden="true">
    <svg width="12" height="12" viewBox="0 0 24 24" fill="none">
        <g id="System" transform="translate(-1296.000000, -48.000000)" fill-rule="nonzero">
            <g id="share_forward_fill" transform="translate(1296.000000, 48.000000)">
                <path d="M24,0 L24,24 L0,24 L0,0 L24,0 Z M12.5934901,23.257841 L12.5819402,23.2595131 L12.5108777,23.2950439 L12.4918791,23.2987469 L12.4918791,23.2987469 L12.4767152,23.2950439 L12.4056548,23.2595131 C12.3958229,23.2563662 12.3870493,23.2590235 12.3821421,23.2649074 L12.3780323,23.275831 L12.360941,23.7031097 L12.3658947,23.7234994 L12.3769048,23.7357139 L12.4804777,23.8096931 L12.4953491,23.8136134 L12.4953491,23.8136134 L12.5071152,23.8096931 L12.6106902,23.7357139 L12.6232938,23.7196733 L12.6232938,23.7196733 L12.6266527,23.7031097 L12.609561,23.275831 C12.6075724,23.2657013 12.6010112,23.2592993 12.5934901,23.257841 L12.5934901,23.257841 Z M12.8583906,23.1452862 L12.8445485,23.1473072 L12.6598443,23.2396597 L12.6498822,23.2499052 L12.6498822,23.2499052 L12.6471943,23.2611114 L12.6650943,23.6906389 L12.6699349,23.7034178 L12.6699349,23.7034178 L12.678386,23.7104931 L12.8793402,23.8032389 C12.8914285,23.8068999 12.9022333,23.8029875 12.9078286,23.7952264 L12.9118235,23.7811639 L12.8776777,23.1665331 C12.8752882,23.1545897 12.8674102,23.1470016 12.8583906,23.1452862 L12.8583906,23.1452862 Z M12.1430473,23.1473072 C12.1332178,23.1423925 12.1221763,23.1452606 12.1156365,23.1525954 L12.1099173,23.1665331 L12.0757714,23.7811639 C12.0751323,23.7926639 12.0828099,23.8018602 12.0926481,23.8045676 L12.108256,23.8032389 L12.3092106,23.7104931 L12.3186497,23.7024347 L12.3186497,23.7024347 L12.3225043,23.6906389 L12.340401,23.2611114 L12.337245,23.2485176 L12.337245,23.2485176 L12.3277531,23.2396597 L12.1430473,23.1473072 Z" id="MingCute" fill-rule="nonzero">

</path>
                <path d="M10.1141,4.49112 L9.91063,7.63542 L9.891,8.05196 L9.8012,8.06134 C5.36297,8.583 2,12.3671 2,17 C2,17.457 2.03414,17.91 2.10168,18.3565 C2.38094,20.2022 2.59088,20.3807 3.87391,18.8547 C4.18977,18.479 4.54227,18.1439 4.91368,17.8247 C6.24977,16.7224 7.90632,16.0786 9.66842,16.0067 L9.894,16.002 L9.95549,17.2308 L10.1215,19.576 C10.2008,20.38 11.0467,20.9293 11.8253,20.4902 C12.1766,20.2919 12.52,20.0809 12.8641,19.8706 C14.652,18.7519 16.3249,17.4666 17.9553,16.1321 C18.9147,15.3326 19.7558,14.5744 20.4714,13.8844 C20.8007,13.5606 21.1304,13.2376 21.4496,12.9037 C21.9118,12.42 21.9575,11.6189 21.4737,11.1124 C20.3603,9.94706 18.7862,8.48751 16.8271,6.94049 C15.2394,5.69825 13.597,4.53773 11.8571,3.51856 C11.0203,3.04172 10.1902,3.69599 10.1141,4.49112 Z" id="路径" fill="currentColor">

</path>
           
        </g>
    </g>
    </svg>
  </span>
  <span class="count"></span>
</button>


            </span>
            </div>
          </div>
        </li>
      {%- endif -%}
    {%- endfor -%}
  </ul>
</section>

<section class="posts">
  <div class="posts-header">
    <h2>AI Projects</h2>

    {% if paginator %}
    <!-- Header pager using the About-style buttons -->
      <nav class="pagination bio-tabs" aria-label="Pagination">
        <div class="tab-buttons">
          <a class="tab-btn prev{% unless paginator.previous_page %} is-disabled{% endunless %}"
             href="{{ paginator.previous_page_path | relative_url }}">← Newer</a>
      
          <span class="tab-btn active" style="pointer-events:none; 
            cursor:default; background:#D2E2FD; color:#01068B;
            letter-spacing: 0.15em;">
            {{ paginator.page }}/{{ paginator.total_pages }}
          </span>
      
          <a class="tab-btn next{% unless paginator.next_page %} is-disabled{% endunless %}"
             href="{{ paginator.next_page_path | relative_url }}">Older →</a>
        </div>
      </nav>
    {% endif %}
  </div>

  <ul id="post-strip" class="post-strip">
    {% if paginator %}
      {% for post in paginator.posts %}
        <li class="post-item">
          <a class="thumb" href="{{ post.url | relative_url }}" aria-label="{{ post.title }}">
            <picture>
              {% if post.thumbnail_mobile %}
                <source srcset="{{ post.thumbnail_mobile | relative_url }}" media="(max-width: 767px)">
              {% endif %}
              {% if post.thumbnail %}
                <source srcset="{{ post.thumbnail | relative_url }}" media="(min-width: 768px)">
              {% endif %}
              <img src="{{ (post.thumbnail | default: post.image | default: '/assets/images/default.webp') | relative_url }}"
                   alt="{{ post.title }}" loading="lazy">
            </picture>
          </a>
          <div class="post-text">
            <a href="{{ post.url | relative_url }}"><strong>{{ post.title }}</strong></a>
            <p class = "snippet" style="color: #737373">
              {% if post.custom_snippet and post.custom_snippet_text %}
                {{ post.custom_snippet_text }}
              {% else %}
                {{ post.excerpt | strip_html | truncate: 70 }}
              {% endif %}
            </p>
            <div class="author-meta">
              <img src="/assets/images/avatar.webp" alt="Rahul" class="author-avatar">
              <span class="author-name">Rahul Bhattacharya</span>
            </div>
            <div class="icon-links">
              {% if post.demo_link %}
                <a class="btn-cta" href="{{ post.demo_link }}" target="_blank" rel="noopener">
                  <img src="/assets/icons/play.svg" alt="Play Icon" 
                    style="height:15px; width: 15px !important; position: relative; top: 4.4px; margin:0 -5px 0 0;">
                </a>
              {% endif %}
              {% if post.github_link %}
                <a class="btn-cta" href="{{ post.github_link }}" target="_blank" rel="noopener">
                  <img src="/assets/icons/github.svg" alt="Github Icon" 
                    style="height:13px; width: 13px !important; position: relative; top: 4.2px; margin:0 -5px 0 0;">
                </a>
              {% endif %}
              <span class="post-stats">
              <button
                class="btn btn--like btn--like--mini"
                type="button"
                data-like-id="{{ post.url | slugify }}"
                data-like-pub="{{ post.date | date: '%Y-%m-%d' }}"
                aria-label="Like this post"
                aria-pressed="false">
                <span class="icon" aria-hidden="true">
                  <svg class="heart" width="12" viewBox="0 0 24 24" fill="none">
                    <path fill-rule="evenodd" clip-rule="evenodd"
                          d="M12 6.00019C10.2006 3.90317 7.19377 3.2551 4.93923 5.17534C2.68468 7.09558 2.36727 10.3061 4.13778 12.5772C5.60984 14.4654 10.0648 18.4479 11.5249 19.7369C11.6882 19.8811 11.7699 19.9532 11.8652 19.9815C11.9483 20.0062 12.0393 20.0062 12.1225 19.9815C12.2178 19.9532 12.2994 19.8811 12.4628 19.7369C13.9229 18.4479 18.3778 14.4654 19.8499 12.5772C21.6204 10.3061 21.3417 7.07538 19.0484 5.17534C16.7551 3.2753 13.7994 3.90317 12 6.00019Z"
                          stroke="#d61f69" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                  </svg>
                </span>
                <span class="count"></span>
              </button>
            </span>
            </div>

          </div>
        </li>
      {% endfor %}
    {% endif %}
  </ul>
</section>

<style>
.post-strip .post-text p {
  font-size: 0.85rem;    /* match Featured */
  line-height: 1.4;
}

/* Optional: unify base + hover so pills feel consistent */
.posts-header .bio-tabs .tab-btn {
  font-weight: 600;
  border: 1px solid #d0d7de;
  border-radius: 999px;
  padding: 4px 10px;
}

/* Disabled edge buttons (when no previous/next) */
.posts-header .bio-tabs .tab-btn.is-disabled {
  opacity: .45;
  pointer-events: none;
}

/* --- Easy color theming via CSS variables --- */
/* Set these wherever you prefer (global :root or scoped to the posts header) */
.posts-header .bio-tabs {
  --pager-active-bg: #D2E2FD; /* change this to your desired background */
  --pager-active-fg: #01068B; /* and this to your desired text color */
}

  /* Tighten space between underline and buttons in header */

.posts-header .bio-tabs,
.posts-header .pagination { margin: 0; }           /* remove bottom margin */

.posts-header .tab-buttons { 
  gap: .5rem;                                       /* optional: tighter pill spacing */
  align-items: flex-end; 
}


  /* Keep "Blog Posts" on one line */
.posts-header h2{
  white-space:nowrap;          /* don't wrap "Blog Posts" */
  margin:0;                    /* avoid extra vertical space */
  line-height:1.2;
}

/* Align the header row neatly with About-style buttons */
.posts-header{
  display:flex;align-items:flex-end;justify-content:space-between;
  gap:.75rem;border-bottom:2px solid #ddd;margin-bottom:1.2rem
}

.posts-header h2{margin:0 0 .4rem 0;font-size:1.4rem;font-weight:700;line-height:1.2}

.pagination{display:flex;justify-content:flex-end}
  
/* Compact like widget for index cards */
.post-text .post-stats{
  margin-top:6px;
}
.btn--like.btn--like--mini{
  display:inline-flex;
  align-items:center;
  gap:4px;
  border:0;
  background: transparent !important;
  padding:0;
  line-height:1;
  cursor:pointer;
}
.btn--like.btn--like--mini .icon .heart{
  width:14px; height:auto;
}
.btn--like.btn--like--mini .label{ display:none; }  /* just heart + number */
.btn--like.btn--like--mini .count{
  font-size:.7rem;
  color:#6b7280;
}


/* Featured: 2 cards per row; each card is image-left + text-right */
.featured-strip{
  list-style:none; margin:0; padding:0;
  display:grid;
  grid-template-columns: repeat(2, minmax(0,1fr)); /* two side-by-side items */
  gap: 14px 18px;  /* row gap, column gap */
}

.featured-strip .post-text .snippet {
  font-size: 0.85rem;    /* smaller body text */
  line-height: 1.4;
}

/* Each card: media layout */
.featured-strip .post-item{
  display:flex;
  align-items:flex-start;
  gap:12px;
  width:100%;
}

/* Image block */
.featured-strip .post-item .thumb{ flex:0 0 auto; display:block; }
.featured-strip .post-item .thumb img{
  width:170px;              /* adjust if you want wider image */
  height:110px;
  object-fit:cover;
  border-radius:10px;
}

.post-strip .post-item .thumb img{
  width:150px;
  height:84px;
  object-fit:cover;
  border-radius:10px;
}

/* Text block */
.featured-strip .post-item .post-text{ flex:1 1 auto; min-width:0; }
.featured-strip .post-item .post-text .title{ display:inline-block; margin-bottom:.25rem; }
.featured-strip .post-item .post-text .snippet{ margin:0; color:#555; }

/* Same fade as blog */
.featured-strip{
  transition: opacity .24s ease, transform .24s ease; opacity:1;
}
.featured-strip.fade-out{ opacity:0; transform:translateY(4px); }
.featured-strip.fade-in { opacity:1; transform:translateY(0); }



/* MOBILE: neutralize main.scss card constraints that create gaps */
@media (max-width: 720px) {

  .post-text .snippet{ display:none !important; }

  /* Let the list be a vertical stack with controlled spacing */
   .post-strip{
    display: flex !important;
    flex-direction: column !important;
    gap: 8px !important;
    margin: 0 !important;
    padding: 0 !important;                 /* overrides main.scss bottom padding */
    list-style: none !important;
    overflow: visible !important;
  }

  /* Override the fixed card width/basis from main.scss */
  .post-strip > .post-item{
    flex: 1 1 auto !important;             /* was flex: 0 0 var(--card-w,180px) */
    max-width: 100% !important;
    gap:8px !important; /* gap between thumbnail and post title */
  }

  /* Make each card row-style (image left, text right) full-width */
  .post-strip .post-item{
    display: flex !important;
    flex-direction: row !important;        /* was column */
    align-items: flex-start !important;
    max-width: 100% !important;            /* was var(--card-w,180px) */
    margin: 0 0 4px 0 !important;
    padding: 0 !important;
  }

  /* Tighten media/text spacing */
  .post-strip .post-item .thumb{
    flex: 0 0 110px !important;            /* give text room */
    max-width: 110px !important;
    margin: 0 !important;                  /* kills .6rem bottom margin from SCSS */
  }

  .post-strip .post-item .post-text{
    flex: 1 1 auto !important;
    min-width: 0 !important;
  }

  .post-strip .post-item .post-text a{
    margin-bottom: 0.2rem !important;      /* was .4rem in SCSS */
  }

  .post-strip .post-item .post-text p{
    margin: 0.3rem 0 0 !important;
    line-height: 1.4 !important;
    font-size: .9rem !important;
  }

  /* Also neutralize the 640px flex-basis=240px rule from main.scss */
  .post-strip > .post-item{ flex-basis: auto !important; }

/* MOBILE ONLY: make blog thumbnails perfect 1:1 squares */

  /* choose your square size once */
  :root { --mobile-thumb: 110px; }   /* try 120–140px if you want larger */

  /* the thumbnail column */
  section.posts .post-strip .thumb{
    flex: 0 0 var(--mobile-thumb) !important;
    width: var(--mobile-thumb) !important;
    max-width: var(--mobile-thumb) !important;
  }

  /* ensure the <picture> wrapper conforms to the square */
  section.posts .post-strip .thumb picture{
    display: block !important;
    width: var(--mobile-thumb) !important;
    height: var(--mobile-thumb) !important;
  }

  /* force the <img> to fill the square and crop neatly */
  section.posts .post-strip .thumb img{
    display: block !important;
    width: var(--mobile-thumb) !important;
    height: var(--mobile-thumb) !important;
    max-width: none !important;        /* override any global img max-width */
    aspect-ratio: 1 / 1 !important;
    object-fit: cover !important;      /* clean crop */
    border-radius: 10px;               /* keep your rounded look */
  }

  /* let text take the rest of the row */
  section.posts .post-strip .post-text{
    flex: 1 1 auto !important;
    min-width: 0 !important;
  }

  /* MOBILE: make Featured stack vertically like Posts */
  /* same container behavior for both lists */
  #post-strip,
  #featured-strip {
    display: flex !important;
    flex-direction: column !important;
    gap: 14px !important;        /* gap between vertical posts */
    margin: 0 !important;
    padding: 0 !important;
    list-style: none !important;
  }

  /* row layout for cards (image left, text right) */
  #featured-strip .post-item,
  #post-strip .post-item {
    display: flex !important;
    flex-direction: row !important;
    align-items: flex-start !important;
    gap: 10px !important;
    margin: 0 !important;
    padding: 0 !important;
    max-width: 100% !important;
  }

  /* Featured: allow pager JS to hide non-current items */
  #featured-strip .post-item {
    display: flex;                 /* no !important */
    flex-direction: row;
    align-items: flex-start;
    gap: 10px;
    margin: 0;
    padding: 0;
    max-width: 100%;
  }

  /* optional: keep thumbnails consistent (square) */
  :root { --mobile-thumb: 110px; }  /* adjust to 120–140px if desired */

  #featured-strip .thumb,
  #post-strip .thumb {
    flex: 0 0 var(--mobile-thumb) !important;
    max-width: var(--mobile-thumb) !important;
    width: var(--mobile-thumb) !important;
  }

  #featured-strip .thumb picture,
  #post-strip .thumb picture {
    display: block !important;
    width: var(--mobile-thumb) !important;
    height: var(--mobile-thumb) !important;
  }

  #featured-strip .thumb img,
  #post-strip .thumb img {
    display: block !important;
    width: var(--mobile-thumb) !important;
    height: var(--mobile-thumb) !important;
    aspect-ratio: 1 / 1 !important;
    object-fit: cover !important;
    border-radius: 10px;
  }

  #featured-strip .post-text,
  #post-strip .post-text {
    flex: 1 1 auto !important;
    min-width: 0 !important;
  }

  /* compact body copy */
  #featured-strip .post-text p,
  #post-strip .post-text p {
    margin: 0.3rem 0 0 !important;
    line-height: 1.4 !important;
  }

  #featured-strip .post-item[style*="display: none"] { display: none !important; }
  
}

/* Author row under snippets */
.author-meta{
  display:flex;
  align-items:center;
  gap:6px;
  margin-top:6px;
  font-size:.8rem;           /* subtle like the example */
  color:#6b7280;             /* muted gray */
}

.author-meta .author-name{
  line-height:1;
  white-space:nowrap;
}

.author-avatar{
  width:16px;                /* tiny circle */
  height:16px;
  border-radius:50%;
  object-fit:cover;
  display:block;
}

/* Optional: make it even tighter on small phones */
@media (max-width: 480px){
  .author-meta{ font-size:.76rem; gap:5px; }
  .author-avatar{ width:15px; height:15px; }
}

/* Author row — force tiny circle and prevent theme image rules from scaling it */
.post-text .author-meta{
  display:flex;
  align-items:center;
  gap:6px;
  margin-top:6px;
  font-size:.8rem;
  color:#6b7280;
}

.post-text .author-meta .author-avatar{
  width:18px !important;
  height:18px !important;
  border-radius:50% !important;
  object-fit:cover !important;
  display:inline-block !important;
  flex:0 0 18px;            /* reserve tiny fixed space */
  margin:0;                 /* neutralize any global img margins */
  vertical-align:middle;
}

/* optional: slightly smaller on very small phones */
@media (max-width: 480px){
  .post-text .author-meta{ font-size:.76rem; gap:5px; }
  .post-text .author-meta .author-avatar{ width:16px !important; height:16px !important; flex-basis:16px; }
}

  .icon-links{
  display:flex;
  align-items:center;
  gap:10px; /* spacing between demo/github/like */
}

.icon-links img,
.icon-links svg.heart{
  width:18px;
  height:18px;
}

.post-stats{
  display:inline-flex; /* ensures the heart + count stay together */
  align-items:center;
}

/* Share button: no border, no background */
.btn--share.btn--share--mini,
.share-btn {
  display: inline-flex;
  align-items: center;
  gap: 0px;
  border: 0;
  background: transparent;
  padding: 0;
  line-height: 1;
  cursor: pointer;
  color: #2563eb; /* base blue */
}

/* Share count — same as Like count */
.btn--share.btn--share--mini .count
  /*, .share-btn .count*/
{
  font-size: .7rem;
  color: #6b7280; /* muted gray */
  margin-left: -2px;
}

/* Arrow outline by default */
.btn--share.btn--share--mini .icon svg path,
.share-btn .icon svg path {
  fill: none !important;
  stroke: currentColor !important;
  stroke-width: 1;
  stroke-linejoin: round;
  stroke-linecap: round;
}

/* Arrow filled when shared */
.btn--share.btn--share--mini.shared .icon svg path,
.share-btn.shared .icon svg path {
  fill: currentcolor !important;
  stroke: currentcolor !important;
}

/* Kill the square background path */
.btn--share .icon svg path#MingCute,
.share-btn .icon svg path#MingCute {
  fill: none !important;
  stroke: none !important;
}

</style>

<script>
(function(){
  if (window.__fadePager_v5) return; window.__fadePager_v5 = true;

  var section = document.querySelector('section.posts');
  var strip   = section && section.querySelector('#post-strip');
  var pagers  = Array.from(section ? section.querySelectorAll('nav.pagination') : []);
  if (!section || !strip || !pagers.length) return;

  function parseHTML(html){ var t=document.createElement('template'); t.innerHTML=html; return t.content; }
  function fetchPage(url){ return fetch(url,{credentials:'same-origin'}).then(r=>r.text()); }
  function syncPagersFrom(doc){
    var src = doc.querySelector('section.posts nav.pagination');
    if (!src) return;
    pagers.forEach(p=>{ p.innerHTML = src.innerHTML; });
  }

  function selNextFrom(doc){
    var a = doc.querySelector('section.posts nav.pagination .next');
    return (a && !a.classList.contains('is-disabled')) ? a.getAttribute('href') : null;
  }
  function selPrevFrom(doc){
    var a = doc.querySelector('section.posts nav.pagination .prev');
    return (a && !a.classList.contains('is-disabled')) ? a.getAttribute('href') : null;
  }

  function computeColumns(){
    var first = strip.querySelector('li.post-item');
    if (!first) return 1;
    var r = first.getBoundingClientRect();
    var cs = getComputedStyle(strip);
    var gap = parseFloat(cs.columnGap || cs.gap || 0) || 0;
    var cardW = r.width;
    var contW = strip.clientWidth;
    return Math.max(1, Math.floor((contW + gap) / (cardW + gap)));
  }

  function cardKey(li){
    var a = li.querySelector('.thumb, a[href]');
    return a ? a.getAttribute('href') : Math.random().toString(36);
  }

  function getCardsFrom(url){
    if (!url) return Promise.resolve({doc:null,cards:[]});
    return fetchPage(url).then(html=>{
      var doc   = parseHTML(html);
      var cards = Array.from(doc.querySelectorAll('section.posts ul li.post-item'));
      return {doc:doc, cards:cards};
    });
  }

  // Top up: try next pages, then previous pages, until we fill the row
  function topUpRow(seedDoc){
    var need = computeColumns() - strip.children.length;
    if (need <= 0) return Promise.resolve();

    var seen = new Set(Array.from(strip.children).map(cardKey));
    var nextHref = selNextFrom(seedDoc || document);
    var prevHref = selPrevFrom(seedDoc || document);

    function take(cards, howMany){
      var taken = [];
      for (var i=0;i<cards.length && taken.length<howMany;i++){
        var k = cardKey(cards[i]);
        if (seen.has(k)) continue;
        seen.add(k);
        taken.push(cards[i]);
      }
      taken.forEach(li=>strip.appendChild(li));
      return howMany - taken.length;
    }

    function fillForward(rem){
      if (rem <= 0 || !nextHref) return Promise.resolve(rem);
      return getCardsFrom(nextHref).then(({doc,cards})=>{
        rem = take(cards, rem);
        nextHref = doc ? selNextFrom(doc) : null;
        return (rem>0 && nextHref) ? fillForward(rem) : rem;
      }).catch(()=>rem);
    }

    function fillBackward(rem){
      if (rem <= 0 || !prevHref) return Promise.resolve(rem);
      return getCardsFrom(prevHref).then(({doc,cards})=>{
        // from prev page take from the END so we don’t just re-show its first items
        cards = cards.slice().reverse();
        rem = take(cards, rem);
        prevHref = doc ? selPrevFrom(doc) : null;
        return (rem>0 && prevHref) ? fillBackward(rem) : rem;
      }).catch(()=>rem);
    }

    return fillForward(need).then(fillBackward).then(()=>{ /* done */ });
  }

  var busy = false;

  function fadeSwap(newLis, newDoc){
    strip.classList.add('fade-out');
    setTimeout(function(){
      strip.innerHTML = '';
      newLis.forEach(li=>strip.appendChild(li));
      syncPagersFrom(newDoc);
      strip.classList.remove('fade-out');
      void strip.offsetWidth;
      strip.classList.add('fade-in');

      topUpRow(newDoc).finally(function(){
        setTimeout(()=>strip.classList.remove('fade-in'), 260);
        busy = false;
      });
    }, 260);
  }

  function handle(dir){
    if (busy) return;
    var link = section.querySelector('nav.pagination ' + (dir===1?'.next':'.prev'));
    if (!link || link.classList.contains('is-disabled')) return;
    var href = link.getAttribute('href'); if (!href) return;

    busy = true;
    pagers.forEach(p=>p.querySelectorAll('a,button').forEach(a=>a.classList.add('is-disabled')));

    fetchPage(href).then(html=>{
      var doc = parseHTML(html);
      var cards = doc.querySelectorAll('section.posts ul li.post-item');
      if (!cards.length){ busy=false; return; }
      fadeSwap(Array.from(cards), doc);
    }).catch(()=>{ busy=false; });
  }

  // Pager clicks
  document.addEventListener('click', function(e){
    var a = e.target.closest('section.posts nav.pagination a');
    if (!a) return;
    e.preventDefault();
    e.stopPropagation();
    e.stopImmediatePropagation();
    if (a.classList.contains('prev')) handle(-1);
    else if (a.classList.contains('next')) handle(1);
  }, true);

  // First paint + resize top-up
  window.addEventListener('load', function(){ setTimeout(function(){ topUpRow(document); }, 50); });
  var rAF, lastW = 0;
  window.addEventListener('resize', function(){
    if (strip.clientWidth === lastW) return;
    lastW = strip.clientWidth;
    if (rAF) cancelAnimationFrame(rAF);
    rAF = requestAnimationFrame(function(){ topUpRow(document); });
  });
})();
</script>

<script>
(function(){
  var strip = document.getElementById('featured-strip');
  var pager = document.querySelector('.featured-pager');
  if (!strip || !pager) return;

  var items = Array.from(strip.querySelectorAll('li.post-item'));
  var pageSize = 2;                                   // 2 cards per page
  var totalPages = Math.max(1, Math.ceil(items.length / pageSize));
  var cur = 1;

  var prev = pager.querySelector('.prev');
  var next = pager.querySelector('.next');
  var counter = pager.querySelector('.tab-btn.active');

  var busy = false;                                   // ← guard during fade

  function render(){
    busy = true;
    strip.classList.add('fade-out');
    setTimeout(function(){
      items.forEach(el => el.style.display = 'none');
      var start = (cur - 1) * pageSize;
      items.slice(start, start + pageSize).forEach(el => el.style.display = '');

      counter.textContent = cur + '/' + totalPages;
      prev.classList.toggle('is-disabled', cur <= 1);
      next.classList.toggle('is-disabled', cur >= totalPages);

      strip.classList.remove('fade-out');
      void strip.offsetWidth;                         // reflow
      strip.classList.add('fade-in');
      setTimeout(function(){
        strip.classList.remove('fade-in');
        busy = false;
      }, 260);
    }, 260);
  }

  function go(delta){
    if (busy) return;                                 // ← ignore while animating
    var target = cur + delta;
    if (target < 1 || target > totalPages) return;
    cur = target;
    render();
  }

  // Capture-phase handler that *blocks* any other global .tab-btn listeners
  document.addEventListener('click', function(e){
    var a = e.target.closest('.featured-pager a.tab-btn');
    if (!a) return;

    e.preventDefault();
    e.stopPropagation();
    e.stopImmediatePropagation();                     // ← hard stop others

    if (a.classList.contains('is-disabled')) return;
    if (a.classList.contains('prev')) go(-1);
    else if (a.classList.contains('next')) go(1);
  }, true);                                           // ← capture

  render(); // initial paint
})();
</script>


