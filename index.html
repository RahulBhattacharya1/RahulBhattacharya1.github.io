---
layout: default
title: "Rahul's Portfolio"
---

<section class="featured">
  <h2>Featured</h2>
  <ul>
    {%- for post in site.posts -%}
      {%- if post.featured == true -%}
        <li class="post-item">
          <a class="thumb" href="{{ post.url | relative_url }}" aria-label="{{ post.title }}">
            <img src="{{ (post.thumbnail | default: post.image | default: '/assets/images/default.webp') | relative_url }}" alt="{{ post.title }}" loading="lazy">
          </a>
          <div class="post-text">
            <a href="{{ post.url | relative_url }}"><strong>{{ post.title }}</strong></a>
            <p style="color: #737373">
              {% if post.custom_snippet and post.custom_snippet_text %}
                {{ post.custom_snippet_text }}
              {% else %}
                {{ post.excerpt | strip_html | truncate: 200 }}
              {% endif %}
            </p>
          </div>
        </li>
      {%- endif -%}
    {%- endfor -%}
  </ul>
</section>

<section class="posts">
  <div class="posts-header">
    <h2>Blog Posts</h2>
    {% if paginator %}
    <nav class="pagination premium" aria-label="Pagination">
      <a class="page-btn prev{% unless paginator.previous_page %} is-disabled{% endunless %}"
         href="{{ paginator.previous_page_path | relative_url }}">← Newer</a>
      <span class="page-status">{{ paginator.page }}/{{ paginator.total_pages }}</span>
      <a class="page-btn next{% unless paginator.next_page %} is-disabled{% endunless %}"
         href="{{ paginator.next_page_path | relative_url }}">Older →</a>
    </nav>
    {% endif %}
  </div>

  <ul id="post-strip" class="post-strip">
    {% for post in paginator.posts %}
      <li class="post-item">
        <a class="thumb" href="{{ post.url | relative_url }}" aria-label="{{ post.title }}">
          <img src="{{ (post.thumbnail | default: post.image | default: '/assets/images/default.webp') | relative_url }}" alt="{{ post.title }}" loading="lazy">
        </a>
        <div class="post-text">
          <a href="{{ post.url | relative_url }}"><strong>{{ post.title }}</strong></a>
          <p style="color: #737373">
            {% if post.custom_snippet and post.custom_snippet_text %}
              {{ post.custom_snippet_text }}
            {% else %}
              {{ post.excerpt | strip_html | truncate: 200 }}
            {% endif %}
          </p>
        </div>
      </li>
    {% endfor %}
  </ul>
</section>

<style>
/* ───────── Posts header pagination (unchanged look) ───────── */
.posts-header{display:flex;align-items:flex-end;justify-content:space-between;gap:.75rem;border-bottom:2px solid #ddd;margin-bottom:1.4rem}
.posts-header h2{margin-bottom:6px;font-size:1.4rem;font-weight:700;line-height:1.2}
.posts-header .pagination{display:flex;align-items:flex-end;gap:.5rem;white-space:nowrap;margin-bottom:6px}
.posts-header .page-btn{padding:4px 10px;font-size:.9rem;font-weight:600;line-height:1;border-radius:999px;background:linear-gradient(135deg,#a78bfa,#7c6ff6);color:#fff;border:1px solid rgba(255,255,255,.35);box-shadow:0 6px 18px rgba(124,111,246,.28);transition:transform .16s ease,box-shadow .16s ease}
.posts-header .page-btn:hover{transform:translateY(-1px)}
.posts-header .page-btn.is-disabled{opacity:.45;background:linear-gradient(135deg,#bbb,#999)}
.posts-header .page-status{padding:3px 8px;font-size:.9rem;font-weight:700;color:#0b1020;border-radius:999px;background:linear-gradient(180deg,#fff,#f6f7fb);border:1px solid rgba(15,23,42,.08)}

/* ───────── Horizontal strip: robust + premium, no jitters ───────── */
.post-strip{
  --card-w: 300px;
  display:flex;
  gap:.75rem;
  overflow-x:auto;
  overflow-y:hidden;
  margin:0;
  list-style:none;
  padding:0 .25rem .75rem;
  scroll-snap-type:x mandatory;        /* strict snap: no drift */
  scroll-behavior:smooth;              /* native smooth (stable) */
  -webkit-overflow-scrolling:touch;
  mask-image: linear-gradient(to right, transparent 0, #000 24px, #000 calc(100% - 24px), transparent 100%);
}
.post-strip > .post-item{
  flex:0 0 var(--card-w);
  scroll-snap-align:start;
}

/* Stacked card so snippet occupies space under image */
.post-strip .post-item{display:flex;flex-direction:column;align-items:stretch;max-width:var(--card-w)}
.post-strip .post-item .thumb{display:block;flex:0 0 auto;margin-bottom:.6rem}
.post-strip .post-item .post-text{flex:1 1 auto;display:flex;flex-direction:column}
.post-strip .post-item .post-text a{margin-bottom:.4rem}
.post-strip .post-item .post-text p{flex:1 1 auto;margin:0;font-size:.9rem;line-height:1.4;color:#555}

/* Slimmer scrollbar */
.post-strip::-webkit-scrollbar{height:6px}
.post-strip::-webkit-scrollbar-thumb{background:#cfd2da;border-radius:999px}

/* Compact on mobile */
@media (max-width:640px){
  .post-strip{--card-w: 240px}
}
</style>

<script>
(function(){
  if (window.__stableStripFix_v2) return; window.__stableStripFix_v2 = true;

  var section = document.querySelector('section.posts');
  if (!section) return;
  var strip = section.querySelector('#post-strip');
  var pager = section.querySelector('.posts-header .pagination');
  if (!strip || !pager) return;

  function parseHTML(html){ var t=document.createElement('template'); t.innerHTML=html; return t.content; }
  function fetchPage(url){ return fetch(url,{credentials:'same-origin'}).then(function(r){ return r.text(); }); }
  function updatePagers(doc){
    var src = doc.querySelector('.posts-header .pagination');
    if (src && pager) pager.innerHTML = src.innerHTML;
  }

  // --- precise paging helpers -------------------------------------------------
  function gapPx(){
    var g = getComputedStyle(strip).gap || "0";
    return parseFloat(g) || 0;
  }
  function cardWidth(){
    var first = strip.querySelector(':scope > .post-item');
    return first ? first.getBoundingClientRect().width + gapPx() : 320;
  }
  function pageStep(){                       // number of whole cards per "page"
    var w = strip.clientWidth + gapPx();
    return Math.max(1, Math.floor(w / cardWidth()));
  }
  function indexAtScroll(){                  // index of the leftmost fully-visible-or-next card
    var x = strip.scrollLeft;
    var kids = strip.querySelectorAll(':scope > .post-item');
    for (var i=0;i<kids.length;i++){
      if (kids[i].offsetLeft >= x - 1) return i;
    }
    return kids.length - 1;
  }
  function scrollToIndex(idx){
    var kids = strip.querySelectorAll(':scope > .post-item');
    idx = Math.max(0, Math.min(kids.length-1, idx));
    var el = kids[idx];
    if (el) strip.scrollTo({ left: el.offsetLeft, behavior: 'smooth' });
  }

  // Guard against double fetch
  var busy = false;

  // Append/prepend exactly one page and land on the first new card
  function loadAndGo(dir){
    if (busy) return; busy = true;

    var link = pager.querySelector(dir === 1 ? '.next:not(.is-disabled)' : '.prev:not(.is-disabled)');
    if (!link || !link.getAttribute('href')){ busy = false; return; }

    var href = link.getAttribute('href');
    pager.querySelectorAll('a.page-btn').forEach(function(a){ a.classList.add('is-disabled'); });

    var beforeCount = strip.querySelectorAll(':scope > .post-item').length;

    fetchPage(href).then(function(html){
      var doc = parseHTML(html);
      var incoming = doc.querySelectorAll('section.posts ul li.post-item');
      if (!incoming.length) return;

      if (dir === 1){
        // Append all, then scroll to the first of the *new* ones
        incoming.forEach(function(li){ strip.appendChild(li); });
        scrollToIndex(beforeCount);                     // exact first new card
      }else{
        // Prepend while preserving current visual position, then land at last of newly added block
        var firstBefore = strip.firstElementChild;
        var leftBefore = firstBefore ? firstBefore.getBoundingClientRect().left : 0;

        Array.from(incoming).forEach(function(li){ strip.prepend(li); });

        if (firstBefore){
          var leftAfter = firstBefore.getBoundingClientRect().left;
          strip.scrollLeft += (leftAfter - leftBefore); // cancel jump
        }
        var newCount = incoming.length;
        scrollToIndex(newCount - 1);                    // exact last of the new block
      }
      updatePagers(doc);
    }).catch(function(){})
      .finally(function(){ busy = false; });
  }

  // Clicks: enabled → fetch one page; disabled → local jump to start/end
  pager.addEventListener('click', function(e){
    var a = e.target.closest('a.page-btn');
    if (!a) return;
    e.preventDefault();

    if (a.classList.contains('is-disabled')){
      if (a.classList.contains('prev')){
        // Disabled "Newer" → jump to first card
        scrollToIndex(0);
      }else if (a.classList.contains('next')){
        // Disabled "Older" → jump to last page-aligned block
        var kids = strip.querySelectorAll(':scope > .post-item').length;
        var step = pageStep();
        var lastStart = Math.max(0, kids - step);
        scrollToIndex(lastStart);
      }
      return;
    }

    // Enabled links: move exactly one page via fetch
    loadAndGo(a.classList.contains('next') ? 1 : -1);
  }, { capture:true });

  // Optional: keyboard support (ArrowLeft/Right to page)
  strip.addEventListener('keydown', function(ev){
    if (ev.key !== 'ArrowRight' && ev.key !== 'ArrowLeft') return;
    ev.preventDefault();
    var step = pageStep();
    var base = indexAtScroll();
    scrollToIndex(base + (ev.key === 'ArrowRight' ? step : -step));
  });
  strip.setAttribute('tabindex','0'); // focusable for keyboard paging
})();
</script>

